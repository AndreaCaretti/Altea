@customera-subdomain = ccp-customera
@provider-subdomain = ccp-provider-dev-qas
@space = dev
@cap-service-url = mtt-cap-services

@token = {{getToken.response.body.$.access_token}}

### Get bearer token
# @name getToken
GET https://{{customera-subdomain}}.authentication.eu10.hana.ondemand.com/oauth/token?grant_type=client_credentials&response_type=token HTTP/1.1
Authorization: Basic sb-ccp-provider-dev-qas-dev-cloud-cold-chain!t61773 oEPmeoq3s9kvPuGZsd89POK9Eo8=

### Get HandlingUnitsRawMovements
GET https://{{provider-subdomain}}-{{space}}-{{cap-service-url}}.cfapps.eu10.hana.ondemand.com/handling-unit-moved/HandlingUnitsRawMovements HTTP/1.1
Authorization: Bearer {{token}}

### Create HandlingUnitsRawMovements
POST http://{{provider-subdomain}}-{{space}}-{{cap-service-url}}.cfapps.eu10.hana.ondemand.com/handling-unit-moved/HandlingUnitsRawMovements HTTP/1.1
Authorization: Bearer {{token}}
Content-Type: application/json

{
    "CP_ID": "90abe75c-e2c6-4e5f-a12f-fb81aa50d011",
    "TE": "1904-10-14T09:01:33.763Z",
    "TS": "1905-10-14T09:01:34.763Z",
    "SSCC_ID": "1234",
    "DIR": "B"
}

### Get SSCC
GET https://{{provider-subdomain}}-{{space}}-{{cap-service-url}}.cfapps.eu10.hana.ondemand.com/services/HandlingUnits HTTP/1.1
Authorization: Bearer {{token}}
Content-Type: application/json

### Create SSCC
POST https://{{provider-subdomain}}-{{space}}-{{cap-service-url}}.cfapps.eu10.hana.ondemand.com/services/HandlingUnits HTTP/1.1
Authorization: Bearer {{token}}
Content-Type: application/json

{
    "ID": "123456789012345678"
}

### Get Books
GET https://{{provider-subdomain}}-{{space}}-{{cap-service-url}}.cfapps.eu10.hana.ondemand.com/handling-unit-moved/Books?$count=true HTTP/1.1
Authorization: Bearer {{token}}
Content-Type: application/json

## Promemoria per autenticazione con grant_type code, funziona solo da browser a causa di redirect e javascript che viene eseguito sulla pagina

# ## Il recupero del code funziona solo da browser quindi lanciare questa chiamata dal browser e copiare il code che appare nell'url:
# GET https://ccp-customera.authentication.eu10.hana.ondemand.com/oauth/authorize?response_type=code&client_id=sb-dev-cloud-cold-chain!t61773 HTTP/1.1

# ## Copiare il code e metterlo in fondo, anche questa chiamata funziona solo da browser perch√® gli servono i cookie di sessione
# GET https://ccp-customera.authentication.eu10.hana.ondemand.com/oauth/token?grant_type=authorization_code&code=XXXXXXXX HTTP/1.1

### Create ControlPoint
POST https://{{provider-subdomain}}-{{space}}-{{cap-service-url}}.cfapps.eu10.hana.ondemand.com/handling-unit-moved/ControlPoints  HTTP/1.1
Authorization: Bearer {{token}}
Content-Type: application/json

{
    "ID": "90abe75c-e2c6-4e5f-a12f-fb81aa50d011"
}


### Create HandlingUnits (SSCC)
POST https://{{provider-subdomain}}-{{space}}-{{cap-service-url}}.cfapps.eu10.hana.ondemand.com/handling-unit-moved/HandlingUnits  HTTP/1.1
Authorization: Bearer {{token}}
Content-Type: application/json

{
    "ID": "TEST123"
}
